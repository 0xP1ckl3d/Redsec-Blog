---
layout: post
title: "Modern Stage-One Payload Delivery Techniques on Windows (2025)"
date: 2025-04-21 20:00:00 +1000
tags: [phishing, payloads]
categories: [Red Team Operations]
---
## Introduction  
In 2025, both red team operators and real‑world threat actors have evolved their techniques for delivering initial (“stage one”) malware payloads on Windows systems. Over the past few years, security improvements by vendors like Microsoft, Google, and Adobe have disrupted many classic attack vectors – for example, the enforcement of Mark‑of‑the‑Web (MOTW) in Microsoft Office now blocks VBA macros from Internet‑sourced documents by default. Likewise, browsers and email services aggressively filter dangerous file types, and operating systems impose new restrictions on running downloaded scripts. Despite these defences, attackers continue to find practical ways to **social‑engineer victims** into running malicious code with minimal friction. This report examines the modern payload‑delivery mechanisms that remain effective in 2025, why they work, and how they are leveraged differently by red teams and threat actors. We focus on Windows as the target environment and provide technical details and examples (e.g. recent malware campaigns and red‑team exercises) to illustrate each technique.

## Evolving Security Controls and Their Impact  
Modern endpoint and software security measures have forced attackers to pivot from older methods to new ones. Understanding these defences is key to appreciating the ingenuity of current payload‑delivery techniques:

- **Mark‑of‑the‑Web (MOTW) & Office Macro Blocking:** Windows adds a MOTW flag (as an NTFS alternate data stream) to files downloaded from the Internet or received via email. Office applications opening such files will run in Protected View and, since 2022, *block any macros outright* unless the file is trusted. This change caused a *66 % drop in macro‑enabled malware attachments* in campaigns through late 2021–2022. Attackers could no longer simply ask users to “Enable Content” on a malicious Excel or Word macro. Microsoft’s tightening of macro security led threat actors to shift to other formats.

- **Attachment Filtering and Extension Blocking:** Email providers and browsers now block or rename many dangerous file types by default. For instance, Outlook and Gmail will not allow `.exe`, `.js`, or `.hta` attachments outright. Google Chrome and Microsoft Edge also warn users or block downloads of files deemed malicious. In some cases, webmail or browser downloads will **replace a risky file’s extension** (for example, appending “.txt” to a `.js` script) so that it no longer executes if clicked. These policies mean malware can’t be delivered as a naked executable or script file in an email – adversaries must conceal or transform their payloads to reach the user’s PC.

- **OS SmartScreen & Attachment Manager:** Windows Defender SmartScreen checks the reputation of downloaded executables and script files when the MOTW flag is present. If a file isn’t a known safe installer, SmartScreen will display a **“Windows protected your PC”** warning or block the file from running without explicit user approval. Additionally, Windows Attachment Manager classifies certain file extensions as **high risk**. For example, if a user tries to open an internet‑downloaded `.vbs` or `.js` script, they may get a security prompt asking for confirmation. These OS‑level restrictions force attackers to either *hide the true file type* or find ways to strip the MOTW so that SmartScreen never intervenes.

- **Hardening of Office and Adobe Software:** Beyond macros, Microsoft and Adobe have closed off other automatic code‑execution paths in documents. Excel 4.0 (XL4) macro sheets were disabled by default around the same time as VBA macros, and Office now blocks certain add‑in types (e.g. **XLL Excel add‑ins from untrusted locations** as of early 2023). Microsoft OneNote – which became a popular malware container – was updated in April 2023 (version 2304) to **block embedded files with dangerous extensions** from opening directly. Previously OneNote would show a warning but allow users to click OK and launch the embedded exe or script; now it flatly prevents opening such files and tells the user to save them to disk instead. Adobe Reader, on the other hand, disables JavaScript in PDFs by default as a security measure, reducing the viability of malicious PDF scripts unless the user is tricked into enabling them. Overall, these app‑level changes have driven attackers toward file formats and techniques that fall outside the typical security models of Office docs and PDFs.

- **Webmail and Cloud Share Protections:** Users are increasingly trained *not* to run unexpected attachments, and many organisations use cloud email security that detonates or scans attachments in sandboxes. To evade these, threat actors often use **cloud‑storage links (OneDrive, Google Drive)** or **password‑protected archives** to deliver malware. By using reputable domains (Microsoft, Google) for delivery, attackers bypass some URL filters, and by encrypting an attachment with a password (supplied in the email text), they prevent automated scanners from examining the content. These approaches reduce the chance of the payload being stripped or flagged before the user interacts with it.

In summary, the security landscape in 2025 has made straight execution of downloaded code difficult. Attackers have countered by concealing payloads in formats that **bypass MOTW propagation**, masquerade as harmless content, or abuse user trust. The following sections detail the payload‑delivery methods currently observed to be effective despite the above controls.

## Container Files and Shortcut Payloads  
One of the most significant adaptations by threat actors was the use of *container files* (archives and disk images) to deliver malicious shortcuts or other content. This method gained popularity as macros fell out of favour. The strategy is to wrap the actual malware inside a file format that **bypasses MOTW tagging** and email filters, requiring only a couple of clicks by the user to unleash the payload.

- **ZIP/RAR/7z Archives:** Compressed archives remain a common delivery medium. Attackers send emails with an attachment like `Invoice_12345.zip` containing a malicious file inside. Because mail gateways can’t easily see inside encrypted archives, using a **password‑protected ZIP** is a popular trick to evade antivirus scanning (the email will include the password in plaintext for the user). Once the user extracts the archive, the extracted files may *not* inherit the MOTW depending on how they were opened. Notably, certain archive utilities do not propagate MOTW flags when using context‑menu extraction. For example, if a user right‑clicks a 7‑Zip archive and chooses “Extract here”, the files won’t be marked as Internet files. This allows a malicious file (e.g. a `.exe` or `.hta`) to run without SmartScreen warnings. Archives can contain all manner of stage‑one payloads discussed later (scripts, documents, etc.), but a prevalent technique is to include a Windows Shortcut `.lnk` file.

- **ISO, IMG and VHD Disk Images:** Attackers discovered that Windows treats mounted disk images as local drives, which historically did **not carry over the MOTW**. In 2022 many malware campaigns began attaching ISO or IMG files (CD/DVD images) renamed with “.iso” extensions inside ZIP files. When the user double‑clicked the `.iso`, Windows would mount it as a new drive letter containing the malware. Prior to a late‑2022 patch, any files inside that ISO would appear as if they came from the local disk, *completely bypassing* the Mark‑of‑the‑Web security checks. This allowed, for example, QakBot (Qbot) malware to be delivered via an ISO containing a `.lnk` shortcut and a DLL – the user double‑clicked the shortcut, which then invoked `rundll32.exe` on the DLL to execute the malware, all without macro prompts or SmartScreen warnings. Microsoft fixed the ISO MOTW bypass in November 2022, but threat actors simply migrated to other container types like **IMG and VHD/VHDX** (virtual disk images) that still don’t support the MOTW alternate data stream. These image files serve the same purpose – an IMG or VHD can carry an embedded malicious file which, once mounted, Windows will run as if it’s a local file. In one real‑world example, attackers used a `.img` attachment to deliver a payload, knowing that when the victim opened it, the contained `.exe` or `.lnk` could execute without SmartScreen blocking. Disk‑image delivery has proven effective because many organisations did not initially block such file types, and the additional step of mounting the image is trivial for the user (often automated on double‑click).

- **Malicious LNK Shortcuts:** Windows shortcut files (`.lnk`) are a powerful tool in current payload delivery. A `.lnk` file isn’t just a pointer to an app – it can be crafted to execute arbitrary commands. Attackers hide malware execution behind what looks like a shortcut to a document or folder. For instance, a phishing email might attach “Invoice.lnk” with an icon resembling a PDF or Word file. When the victim opens it, the LNK might quietly launch a command to download and run a payload from the Internet. More often, the LNK is used in combination with the above containers: the phishing email carries a ZIP or ISO, and inside is a benign‑looking LNK plus a payload file. The LNK’s target could be a local payload (e.g. run a DLL or script that’s bundled in the same container) or a remote URL. One common technique is to have the LNK execute PowerShell or MSHTA with a remote script URL. Because the `.lnk` itself is not an executable file, it often bypasses attachment filters that block EXEs. It also doesn’t trigger SmartScreen by itself (the commands it runs might, but by then the chain is in motion). For example, after Microsoft’s macro block, LNK files became the *de facto replacement* in many criminal campaigns. Emotet, QakBot and IcedID malware groups all used phishing attachments with LNK shortcuts in 2022–2023 to initiate their infections. Red teams likewise favour LNK files as a low‑profile launcher: a payload can be stored in a script or binary on a remote server or cloud share, and the LNK simply fetches and executes it when the user clicks. This “split” approach – a benign‑looking file here, actual code hosted there – helps avoid detection. It does mean the victim needs Internet access when they click, but in enterprise scenarios that’s usually available.

**Why it works (2025):** Containers and shortcuts remain effective because they exploit user familiarity and gaps in security logic. Users are accustomed to downloading ZIPs (e.g. as compressed documents) or ISO images (for software installers), and they are generally *not* met with the same level of suspicion as an EXE file. Attackers capitalise on this by bundling malicious logic in these formats. Technically, the fact that many container formats **strip or bypass the Mark‑of‑the‑Web** is key – it means a malicious file can run as if it were already on the system, avoiding the “this file came from the Internet” warnings. Even after some container loopholes were closed, adversaries found alternatives (like VHD, or abusing archive tools’ behaviour). The use of LNK files adds minimal friction: the user believes they are opening a document or folder, but actually launches code. Since Windows will happily run the command embedded in a shortcut, this method skirts many of the file‑type restrictions that focus on executables or scripts. In essence, **trusted container + hidden shortcut = execution under the radar**. Numerous campaigns in 2023–2024 relied on this formula, and many organisations discovered that while they trained users not to run “.exe” files, an innocuous‑looking “.zip” or “.one” file (OneNote, below) still slipped through. For red teams, these techniques are attractive because they mirror real attacker behaviour and typically blend in with normal user actions, increasing the chance of initial‑access success.

## Malicious OneNote and Office Documents (Macro Alternatives)  
With VBA macros largely neutered by Microsoft’s policies, threat actors and pentesters sought other ways to get code execution via documents. One standout solution has been **Microsoft OneNote** files. OneNote notebooks (`.one` extension) emerged in late 2022 as a new carrier for malware because they allow embedded files and were not subject to the Office macro rules. By early 2023 multiple cybercriminal groups were using OneNote attachments in phishing emails, and red teams began to adopt similar tactics for engagements.

- **OneNote File Attachments:** A OneNote file is essentially a container that can hold embedded objects (attachments) alongside rich text and images. Attackers create a OneNote page that says something like “Double‑click the attachment to view the document” with an embedded file icon (often hidden behind a fake button graphic urging the user to click). The embedded payload can be a script or executable. When the victim opens the `.one` attachment in their OneNote desktop app, they typically get a warning (“Opening attachments may harm your computer. OK/Cancel”). Prior to 2023, if the user clicked OK, the embedded file would launch immediately. This made OneNote files as dangerous as the old macro docs – one click on “OK” and malicious code runs. Threat actors leveraged this to deliver a variety of malware. For example, Proofpoint observed at least 50 distinct OneNote email campaigns in January 2023 delivering malware like AsyncRAT, RedLine Stealer, Agent Tesla and Qbot (Quakbot). An initial‑access broker group (TA577) that had historically used Word macros switched to OneNote for Qbot distribution at that time. OneNote’s appeal was that it’s part of the Office suite (thus not likely blocked by corporate filters initially) and it gave attackers more flexibility in payload type. According to Palo Alto’s analysis of 6 000 malicious OneNote files, the most common embedded payloads were **JavaScript (≈ 47 %) and PowerShell scripts (≈ 34 %)**, followed by batch scripts and VBScript, with actual EXE binaries less common. These scripts are typically small stagers that will download or launch the second‑stage malware. For instance, a OneNote may contain an embedded `invoice.js` that, when executed, runs a WScript command to fetch a DLL or EXE from a remote server. This multi‑step staging helps evade detection by keeping the initial file size and content benign‑looking (script text).

- **Office Files with External Links or DDE:** Aside from OneNote, attackers also found that **linking** was a way to abuse Office without macros. Instead of embedding malicious code, a Word or PDF file might contain a hyperlink or a **document template reference** that points to a malicious file. One common tactic is sending a fairly normal‑looking Office document (or PDF) that, when opened, urges the user to click a link (e.g. “Document is secure, click here to view full content”). The link might lead to a malware download. In a Trellix‑observed campaign in 2024, threat actors delivered innocuous `.pdf`, `.docx` or `.rtf` files that contained **malicious URLs** for the user to click – this still achieved malware download with an extra step of user interaction. Another legacy trick that saw renewed use is **DDE (Dynamic Data Exchange)** in Office: a Word document can be crafted to launch an external application via DDE without macros. This technique prompts the user with a couple of dialogues (which can be confusing enough that some click “Yes”). While Microsoft also patched and warned about DDE abuses, it illustrates how any interactive content in Office can be a vector. Red teamers have occasionally used Word or Excel files that leverage DDE or remote template injection to execute code, especially in environments that heavily filter unknown file types but still allow standard Office docs. These methods require more user clicks (and often raise alerts in modern Office versions), so they are less common than OneNote or shortcut‑based techniques, but they remain in the toolbox for certain scenarios.

- **Publisher, Excel Add‑ins and Niche Office Formats:** Attackers continuously test the less‑travelled paths in the Office ecosystem. For example, Microsoft Publisher (`.pub` files) was found to *not enforce* MOTW macro blocking in tests – a misstep that could allow VBA macros in Publisher to run from an Internet file without the usual block (this is rarely exploited due to Publisher’s low usage). Meanwhile, **Office add‑ins** like Excel’s XLL (covered in the next section) and Word/PowerPoint’s add‑on templates provide another route. Even the legacy Excel 4.0 macro sheets (XL4) saw some use by attackers until they were disabled by default. Finally, some threat actors have tried multi‑file tricks, such as sending a PDF that has an embedded Word document inside it, which in turn has a malicious macro – a convoluted approach to evade scanners that might require multiple user actions (open PDF, then open attachment within PDF, then enable macro).

**Why it works:** OneNote’s success as a malware delivery vehicle in 2023–2024 can be attributed to a few factors. First, users and defenders had a *trust gap* – macros were well‑known as dangerous, but few people suspected a OneNote file. OneNote is often associated with benign note‑taking; thus, an email attachment in OneNote format did not immediately raise red flags. Second, OneNote allowed embedded script files that could run with a simple prompt. This was effectively a new form of “macro” but not yet broadly defended against. Even after Microsoft’s April 2023 update that **blocks direct opening** of high‑risk attachments in OneNote, the technique didn’t vanish overnight. Attackers adapted their instructions to victims, telling them to save the file and open it outside OneNote (which reintroduces a SmartScreen/AV check but some users will proceed anyway). The variety of payloads (scripts, HTA, etc.) that OneNote can carry gave adversaries options to tune their malware for size and evasion. Red teams report that OneNote files have been effective in assessments because many organisations hadn’t yet included `.one` in their email attachment blocklists (a gap that some are now closing). Similarly, using Office files with links or prompts works because it leverages the *pretext* of a normal business document while actually outsourcing the malicious action to an external download. It’s an extra hurdle (the user must click the link or enable something), but as seen in many phishing cases, a convincing lure will get clicks. Threat actors continue to abuse human curiosity and trust – whether it’s a OneNote “remittance advice” or a PDF “secure file” link, people often follow the provided steps, especially if the document impersonates something important (e.g. an invoice, shipment notice or internal memo). In summary, by shifting from obvious macro‑laden docs to less obvious formats and interactive tricks, attackers maintain a foothold in the corporate inbox in 2025.

## Malicious Add‑ins and Executable Files  
Although Office macros were curtailed, attackers found that other **executable content** associated with Office could be used for initial access. In 2025, malware delivery increasingly involves **add‑in files, script executables and even polyglot documents** that execute code. Here we discuss a few notable file types and techniques: Excel XLL add‑ins, compiled help files and direct executables (often camouflaged).

- **Excel XLL Add‑ins:** An XLL file is essentially a DLL plugin for Excel. Unlike macro‑enabled spreadsheets, XLLs are compiled binaries that run native code when loaded by Excel. Starting in late 2022, threat actors massively ramped up use of XLLs to deliver malware. By Q3 2023, malicious XLLs (and related add‑in formats like `.xlam` for Excel or `.ppam` for PowerPoint) became one of the top email threats. The reason is simple: an XLL file, when double‑clicked, will open Excel (which shows a prompt like “Do you want to install this add‑in?”). If the user clicks yes, the add‑in’s code executes **with the same capabilities as a program** – but users might not equate this with running an EXE. Microsoft noticed this abuse and as of early 2023, **blocks XLLs from untrusted sources by default** in Office 365. However, attackers found workarounds. In one campaign delivering the **Parallax RAT** in July 2023, the attackers sent XLL attachments that appeared to be documents (e.g. disguised as invoice add‑ins). They leveraged compromised email accounts to send these, so the attachments may have been implicitly trusted by the victim (e.g. coming from a known partner). If the target saved the XLL to a Trusted Location in Office or if their Office version hadn’t enforced the block yet, the add‑in would load. Once loaded, XLLs can immediately drop files or run payloads. Parallax, for instance, used the XLL to write a Windows executable to the `%ProgramData%` folder and execute it. Another case observed an add‑in delivered for PowerPoint that installed **XWorm** malware via a similar mechanism. Red‑team operators have also explored XLLs as a stealthy option – by creating a malicious XLL that establishes a C2 beacon, they can send it as an “Excel plugin” to targets who may trust internal Excel tools. Notably, **digitally signing** these add‑ins can reduce warnings; one advanced technique by Outflank involved signing a malicious add‑in with a trusted certificate to bypass MOTW and appear as a trusted publisher. This blur between “malicious” and “trusted” code is exactly what makes add‑ins tricky to defend against when default protections are off or bypassed.

- **Compiled HTML Help (CHM) Files:** CHM files (`.chm`) are another example of an old Windows feature repurposed for malware delivery. A CHM file is an HTML‑based help document that can include scripts and links – and it executes in a built‑in Help viewer (using the IE engine) without needing a separate browser. Several malware campaigns (Agent Tesla info‑stealer, Qakbot, etc.) in 2023 started using CHM attachments in phishing emails. The infection chain is direct: the user receives an email with an attached `.chm` (often inside a ZIP to bypass mail blocks). The CHM might have a name like `Invoice123.chm` with an icon of a help book. When opened, it displays what looks like a document or message (sometimes a decoy or just nothing visible) while *covertly executing a malicious script*. For example, a CHM file can automatically run an embedded JavaScript or VBScript when opened. In the AgentTesla case, the CHM ran a hidden PowerShell command that fetched a second‑stage script from a remote server. There is typically little warning to the user beyond maybe a fleeting “loading” dialog. Because CHM is an executable format, updated Outlook clients tend to block it unless zipped. But many endpoint protections did not historically scrutinise CHM content, as it’s a rather uncommon format. Thus, threat actors found success with it as a means to run PowerShell or WScript on the host with a single click. From a red‑team perspective, CHM files can be a neat way to trigger script execution (there are tools that convert HTML or HTA payloads into CHM). However, it’s a less common choice in engagements given that some modern systems will flag unknown CHMs. It still serves as a reminder that *any file type that can execute code is fair game*, even if it’s a Help file from the 1990s.

- **Executable Files and Installers (Masquerading):** Delivering a raw EXE is usually high‑friction in 2025 – SmartScreen will warn, and savvy users know “.exe” files are dangerous. But attackers do at times deliver executables by **masquerading** them. One way is using double extensions or deceptive naming: e.g. an attachment named `Resume.pdf.exe` which on many Windows setups will show as “Resume.pdf” (since `.exe` is the real extension and `.pdf` just part of the name). If file extensions are hidden in Explorer (the default), the victim sees an icon that might even be made to look like a PDF icon and the name “Resume.pdf”. If they click it, it runs the malware. Another trick is to use **code‑signed executables** or MSI installers. A code‑signed malware dropper (especially if signed by a stolen or fake certificate) might launch with fewer warnings or at least appear more legitimate. Microsoft Installer packages (`.msi`) are sometimes less likely to be blocked by email filters than EXEs, so we’ve seen some phishing attacks use an MSI file disguised as a document (one click triggers the install of malware). Attackers also abuse **Windows CLI tools** as payloads – for example, they might send a batch script (.bat) or a Windows Script File (.wsf) and instruct the user to run it, or bundle it in an archive. If a user double‑clicks a batch (`.bat`), it will open a console and run commands (which might fetch further payloads). This is noisy but still effective in some cases. There’s also the concept of **“living off the land” binaries (LOLBins)** for stage one: instead of sending a payload file at all, the attacker sends instructions that cause the target to use built‑in Windows tools to fetch the payload. For instance, a malicious LNK or HTA might invoke `powershell.exe -Command Invoke‑WebRequest ...` to download malware, or use `mshta.exe` to execute a piece of script hosted on a website (often called *HTML Application* malware). All these approaches aim to get some initial code running on the endpoint. The difference with directly delivering an EXE is mainly in *how much the user sees*. If an attacker can hide the fact that something executable is launching (e.g. by using a script or shortcut as the visible file), they stand a better chance of success.

**Why it works:** Add‑ins, CHMs and disguised executables continue to work because they exploit the **grey areas of user knowledge and security coverage**. An Excel add‑in arriving via email might not trigger the same suspicion as a macro, and if the user is persuaded that it’s needed for work (“please install this new Company Finance Plugin”), they might click through the Excel warning. From a system perspective, the add‑in is just another library loaded by Excel, which was an *intended feature* – thus it runs with all permissions Excel has. In effect, Microsoft had to play catch‑up in flagging or blocking these, but motivated attackers find ways around the blocks (such as using trusted sources or novel file names). The use of CHM and similar unconventional formats works because they are **under the radar** – many users have never heard of `.chm`, and some security teams didn’t have it on their blocklists. Opening a CHM doesn’t obviously look like running a program, so users can be caught off guard. Additionally, these file types often *chain* into PowerShell or wscript (which are legitimate Windows components), making detection harder; the malicious action is taken by a trusted system process. Disguised executables and installers prey on user inattention: in a rush, many will double‑click a file that appears to be what they expect (especially if Windows doesn’t show the full extension or if an icon is faked). Attackers also leverage the fact that organisations may allow certain file types through – for instance, a .MSI installer might not be stripped by an email filter because businesses do sometimes send installers. By blending in with normal operations and abusing trust (code signing, internal email accounts to send the file, etc.), these straightforward executable deliveries can still yield results in 2025. Red teams will typically only resort to such methods if simpler ones fail, but nation‑state and criminal actors have used them when the situation allows (for example, we saw the **Kimsuky** APT using CHM files as lures in 2023, and various info‑stealers spread via fake installer attachments). It’s a cat‑and‑mouse game – as soon as one of these becomes too visible (e.g. everyone learned about malicious XLLs), attackers tweak the approach (using ones signed by known vendors or embedding them in other containers).

## HTML Smuggling and Script‑based Delivery  
Not all malware arrives as a file attachment. An increasingly popular technique is **HTML smuggling**, where the email carries an HTML file that, when opened, smuggles a payload onto the victim’s machine via the browser. Alongside this, some attacks deliver malicious scripts directly via download or link, counting on user actions beyond the email client.

- **HTML Attachments (HTML Smuggling):** Instead of sending an executable or document, the phish email might include a `.html` or `.htm` file attachment – for example, “Open_details.html”. When the user clicks this attachment, it opens in their web browser (usually Edge or Chrome). The HTML file is crafted with embedded JavaScript that will automatically create a file (often by assembling a base64‑encoded blob) and prompt the user to save or run it. Essentially, the browser is used as a tool to reconstruct the malware locally, bypassing email security that only saw a harmless‑looking HTML. This is known as HTML smuggling. Microsoft observed this tactic being used for banking malware and ransomware loaders because it evades network‑level defences – the actual binary doesn’t travel over the wire until it’s safely on the host. A typical flow: the user opens the HTML attachment, it shows maybe a “Loading…” screen or a fake message like “Secure File is downloading”, while in the background JavaScript creates a hidden link with a huge blob of data and triggers a download (or directly uses the FileSystem API). The user then finds a file (often a ZIP or ISO or JS file) landing on their disk (the browser will usually ask for confirmation to save – some smuggle techniques even auto‑save to default downloads). The user is then instructed (via on‑screen text in the HTML or the subsequent email steps) to open that downloaded file. For instance, a campaign might deliver an HTML that drops an **ISO containing a 3LOSH JavaScript payload**, or an HTML that directly drops a malicious `update.exe`. Because this method splits delivery (email carries HTML, HTML delivers malware), it’s hard for defenders to detect the complete chain. Red Canary reported multiple phishing waves using HTML smuggling to deliver initial access payloads like AsyncRAT in late 2023. Even some advanced threat actors (e.g. nation‑state groups) have used it to get implants onto systems while avoiding content filters. The only user friction here is the need to open the HTML and then possibly confirm a download – which many users will do if the lure is convincing (the HTML often pretends to be a secure document portal or something official).

- **Direct Script Download/Execution (SocGholish & Others):** There are cases where the initial phishing email contains not an attachment but a link that leads to a compromised website which then uses drive‑by tactics (without exploiting vulnerabilities). One prominent example is **SocGholish**, a malware framework that presents fake browser update pages. A user might receive an email or be redirected via a malvertisement to a page saying “Your Chrome is out of date – download update”. The “update” is a malicious JavaScript file (often in a Zip) that the user is instructed to run. Once run (via WScript), it installs malware. While not an email attachment per se, it’s part of the delivery mechanism trend to use **web‑based social engineering**. SocGholish has been delivering RATs and loaders by convincing users to run `.js` or `.wsf` files since around 2019, and it’s still active as of 2024. In fact, Red Canary noted that AsyncRAT was being delivered via SocGholish JavaScript in 2024 as an alternate to email attachment methods. This technique again relies on abusing built‑in script hosts on Windows. A `.wsf` (Windows Script File) can contain mixed JScript/VBScript and will run if double‑clicked. If it’s smuggled or downloaded and the user launches it, it might call PowerShell or BitsAdmin to pull the next stage.

- **“Paste‑and‑Run” Social Engineering:** A non‑traditional but **effective initial access technique** seen recently (especially among more hands‑on intrusions and red‑team exercises) is to get the user to *manually execute* code. This often involves instructing the user to copy a snippet of text (which is a malicious script/command) and paste it into a console (PowerShell or CMD). Alternatively, attackers convince users to run a legitimate remote admin tool. For instance, in late 2024, a surge in intrusions involved phone‑based phishing (so‑called “callback” scams) where the attacker, posing as tech support, guides the user to install **AnyDesk or TeamViewer** (legitimate remote desktop software). The attacker then directly deploys malware via that remote session. Red Canary highlighted paste‑and‑run as the **#1 initial access technique** in late 2024, used to drop payloads like LummaC2 and Vidar stealers. While this is more interactive than a simple phishing link, it sidesteps many protections because the user is essentially disabling their own security under guidance. From a red‑team viewpoint, this overlaps with techniques like **weaponised help desk** scenarios or using initial phishes to get a user on a call. It’s mentioned here because it shows the extremes to which social engineering can go – even with all the file‑type hardening, one can sometimes just ask the user to run your code! The friction is higher (convincing a user to do that requires a strong pretext), but the success rate can be surprisingly high in targeted attacks where trust is built.

**Why it works:** HTML smuggling and these script‑based approaches underscore a fundamental point: if you can convince the user to execute *anything* you provide (be it an HTML file or a copy‑paste command), you can bypass almost all technical controls. HTML attachments appear benign to email scanners (they’re just text and HTML code), yet they can effectively drop an EXE on the host – leveraging the user’s own browser as the “downloader” means network security products don’t see a signature to block. This is a clever abuse of the trust placed in content that runs in a user’s browser context. It continues to work because users frequently receive HTML attachments for legitimate reasons too (some secure email systems deliver encrypted messages as HTML files the user opens in a browser). Attackers hide in that normalcy. Meanwhile, direct script delivery like SocGholish works on those who have weaker security awareness – someone might genuinely think their browser is telling them to run an update. The reason these keep working in 2025 is that **human nature and system defaults** still present opportunities. Browsers will always render HTML; Windows will always have a way to run scripts for functionality – and where technical exploits are not used, there’s often no security alert, since from the OS perspective *the user initiated these actions*. Red teams leverage HTML smuggling in scenarios where traditional attachments fail, for instance, sending a highly tailored HTML file that drops a Cobalt Strike beacon payload, knowing that the mail filter will likely let it through. Threat actors, especially those distributing commodity malware, love HTML smuggling because it’s cheap and effective at scale (one study noted a particular spike in HTML attachment phishing volume in late 2024 as phishers moved away from docs). As long as users can be enticed to open or run something and the underlying system doesn’t outright forbid it, these techniques will persist.

## Red Team vs Threat Actor: Similar Techniques, Different Constraints  
Modern red teams and threat actors largely converge on the same set of initial‑access techniques – after all, many red teams explicitly emulate threat actor TTPs. However, there are some nuanced differences in how they deploy stage‑one payloads:

- **Scale and Targeting:** Cyber‑criminal groups often operate on a broad scale, sending thousands of generic phishing emails with malware attachments (e.g. a widespread campaign with OneNote files targeting many organisations). They rely on some percentage of users taking the bait. A red team, conversely, usually works **targeted** within one client environment. This means red teamers can invest more effort per target – for instance, crafting a very specific lure (maybe an Office add‑in that appears custom for that company) or choosing a delivery method that fits the target’s profile. Threat actors do use specific lures for high‑value targets (e.g. APT spear‑phishing may use customised decoy documents), but in crimeware the volume approach dominates. Red teams, bound by rules of engagement, also avoid “spray and pray” methods that might unintentionally affect systems outside the target scope.

- **Safety and Stealth:** A key difference is that red teams must operate safely. They will avoid techniques that could cause unintended damage or trip widespread alarms too early. For example, a red team might shy away from using a known malware sample (which AV would catch and quarantine, alerting the SOC) and instead deliver a benign‑looking stager they wrote or a C2 agent with low detection. Both might use the **same delivery vector** (say, an ISO+LNK), but the **payload content** often differs – threat actors might drop ransomware or a noisy credential stealer, whereas red teams drop a silent beacon that merely connects back for further instructions. Red team payloads often incorporate more obfuscation to evade enterprise EDR solutions, or they might use packers like 3LOSH (which is available commercially) to crypterise their stage‑one like real attackers do. The end goal diverges (persistent access and data theft for criminals vs. demonstrating risk for red team), but the initial stage delivery looks similar.

- **Use of Trusted Infrastructure:** Red teams are careful about the **source of payloads**. APTs and criminals might send malware from a hacked email account of a business partner or host payloads on compromised legitimate websites – essentially abusing trust relationships to increase success. Red teams can’t compromise a third‑party just to improve phish success (that would be out‑of‑scope), so they simulate this by purchasing look‑alike domains or using cloud services that the target trusts. For instance, instead of sending an XLL from a known compromised vendor account, a red team might use an Office 365 tenant and a OneDrive share link to send the file, so it *appears* to come from a familiar cloud source. The difference is subtle: the threat actor might have the actual internal thread, whereas the red team creates a fake but convincing scenario. In both cases, the victim sees a seemingly trustworthy context for the payload (and thus is more likely to run it).

- **Cutting‑Edge vs Reliable:** Threat actors, especially sophisticated ones, sometimes deploy *brand‑new techniques or 0‑day exploits* to deliver payloads (for example, a novel MOTW bypass or an exploit in the browser to auto‑run malware). Red teams, guided by ethics and scope, usually **avoid using exploits** that could crash systems or aren’t patched (unless explicitly allowed in a red team engagement). The focus here was on non‑zero‑day techniques, but it’s worth noting that real attackers can take more risks if the payoff is high, burning a new vulnerability to get that initial foothold. Red teams instead tend to stick to techniques that are known to work and won’t break the target’s environment. In practice, many of the techniques detailed in this report (like HTML smuggling, OneNote files, etc.) were first observed in the wild by threat actors and later adopted by red teams once they proved effective and safe enough to emulate.

- **Operational Cadence:** Once initial access is achieved, threat actors often move quickly to execute their mission (whether it’s installing ransomware within hours or exfiltrating data). A red team will typically *pause* after initial access to ensure the access is stable and to coordinate next steps with the engagement plan. This sometimes means red teamers favour payloads that give long‑term remote access (C2 beacons) without drawing attention, whereas a criminal might be fine dropping a loader that immediately starts credential harvesting (and risk detection) because they intend to quickly follow up with secondary payloads like ransomware. This difference doesn’t change the delivery mechanism, but it influences what stage‑one does after execution. For example, an APT might drop a robust backdoor as stage‑one, whereas a red team might drop a lightweight stager that only later loads a full backdoor once they validate it’s not detected.

In summary, red teams and threat actors in 2025 share a common toolkit for getting that first code running on a Windows host – be it a malicious OneNote, a shortcut in an ISO, or an HTML smuggled dropper. The divergence lies in how they *package* and *follow up* on that access. Red teams tailor and temper their methods to avoid undue disruption, while threat actors optimize for success rate and speed. Nonetheless, any organisation looking to defend against one should consider the techniques of both, as they often overlap heavily in the initial‑access phase.

## Conclusion and Observations  
Despite major advancements in security, the battle for initial access on Windows in 2025 is still very much alive. Attackers have proven adept at **finding the weakest link – which is often human curiosity or procedural gaps** – and leveraging it with new file types and delivery tactics. From the resurgence of malicious shortcuts and disk images to the creative abuse of OneNote and HTML files, the first stage of compromise has only grown more varied since the death of widespread Office macros. These techniques continue to work largely because they exploit the trust users have in certain file formats and the inherent need for users to open files in their day‑to‑day jobs. As we’ve seen, a convincing lure and a file that behaves *just enough* like a normal document can defeat even layered defences if the user is persuaded to take that final step.

For defenders and penetration testers, there are a few key takeaways from this analysis:

- **Layered Security is a Must:** No single solution will catch all these techniques. Organisations should update email filtering to block or flag uncommon attachment types (e.g. `.one`, `.iso`, `.lnk`, `.chm`), train users to verify unexpected file prompts (e.g. OneNote’s new blocking dialog), and ensure that endpoint policies (like Smart App Control or AppLocker) are configured to block script hosts or untrusted add‑ins where possible. Defence‑in‑depth is needed because attackers only need one gap (be it an unpatched MOTW bypass or a user willing to run “update.js”).

- **User Awareness and Training:** Many of these payloads *require user action*. Emphasising the dangers of unusual file types and reinforcing a culture of scepticism can dramatically reduce success. For instance, a user who knows that “.js files should never be double‑clicked” or that “Excel will never email you a plugin to install” is a user less likely to fall victim. The challenge is keeping up with the new lures – today it might be OneNote files, tomorrow it could be something like a malicious Settings file or even a fake “Windows Update” attachment.

- **Monitoring for Execution Chains:** On the detection front, understanding these delivery methods allows security teams to watch for tell‑tale behaviours. For example, seeing `wscript.exe` spawning PowerShell (or vice versa) is a suspicious indicator in many of these script‑based attacks. Similarly, an Office process spawning `cmd.exe` or `rundll32.exe` (which happens with malicious add‑ins or LNKs) should be treated as an anomaly to investigate. By mapping these techniques to MITRE ATT&CK (many fall under Initial Access via Spearphishing Attachment and Execution via User Interaction), defenders can deploy specific hunt and detection rules.

In the eternal cat‑and‑mouse game, red teams and threat actors will continue to innovate in stage‑one delivery – perhaps abusing new file formats or novel cloud services next. As of 2025, however, the methods covered in this report represent the state‑of‑the‑art in practical payload delivery. Both attackers and defenders are learning from each engagement. By studying the successes of these techniques in real campaigns, security professionals can better prepare for the next phishing email that inevitably slips into an inbox carrying more than just words. In the end, vigilance and adaptability remain the best defence, just as creativity and social engineering remain the attacker’s best offence.

---

## Sources  

- Microsoft 365 Defender Blog – *“VBA macros are now blocked by default”* (February 2022)  
  <https://www.microsoft.com/security/blog/2022/02/07/vba-macros-now-blocked-by-default>  

- Microsoft 365 Defender Blog – *“From macros to ISO: how threat actors adapted”* (December 2022)  
  <https://www.microsoft.com/security/blog/2022/12/14/threat-actors-shift-from-macros-to-iso-img-vhd/>  

- Proofpoint – *“Cybercriminals weaponise OneNote documents to deliver malware”* (January 2023)  
  <https://www.proofpoint.com/us/blog/threat-insight/cybercriminals-weaponize-onenote-deliver-malware>  

- Palo Alto Networks Unit 42 – *“Malicious OneNote Attachments on the Rise”* (March 2023)  
  <https://unit42.paloaltonetworks.com/onenote-delivered-malware/>  

- Red Canary – *2024 Threat Detection Report* (February 2024)  
  <https://redcanary.com/blog/threat-detection-report-2024/>  

- Microsoft Threat Intelligence – *“HTML Smuggling Surges in Email Campaigns”* (June 2024)  
  <https://www.microsoft.com/security/blog/2024/06/12/html-smuggling-email-campaigns/>  

- Trellix Labs – *“Weaponised PDFs and DOCX Files with External Links”* (April 2024)  
  <https://www.trellix.com/content-labs/weaponised-docs-links-2024>  

- The DFIR Report – *“Qakbot via ISO and LNK Shortcut”* (August 2023)  
  <https://thedfirreport.com/2023/08/24/qakbot-iso-infection-chain/>  

- Outflank – *“Abusing signed Office Add-ins (XLL) for Execution”* (July 2023)  
  <https://outflank.nl/blog/2023/07/14/signed-xll-abuse/>  

- Cisco Talos – *“CHM File Attachments Deliver AgentTesla”* (November 2023)  
  <https://blog.talosintelligence.com/chm-agent-tesla-campaign/>  

- Elastic Security Labs – *“Excel XLL Add‑ins: Emerging Threat Vector”* (September 2023)  
  <https://www.elastic.co/security-labs/excel-xll-threat-vector>  
